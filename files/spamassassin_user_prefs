# SpamAssassin user preferences file.  See 'perldoc Mail::SpamAssassin::Conf'
# for details of what can be tweaked.
#* 
#* Note: this file is not read by SpamAssassin until copied into the user
#* directory. At runtime, if a user has no preferences in their home directory
#* already, it will be copied for them, allowing them to perform personalised
#* customisation.  If you want to make changes to the site-wide defaults,
#* create a file in /etc/spamassassin or /etc/mail/spamassassin instead.
###########################################################################

rewrite_header Subject *****SPAM*****

clear_headers
fold_headers 1
add_header all Level _STARS(*)_
#add_header all _TESTSSCORES(,)_ [2]
add_header all Status _YESNO_, score=_SCORE_ required=_REQD_ tests=_TESTS_ autolearn=_AUTOLEARN_ version=_VERSION_ releay=_RELAYCOUNTRY_
add_header all Checker-Version SpamAssassin _VERSION_ (_SUBVERSION_) on _HOSTNAME_
add_header all Report _REPORT_
add_header all Relay-Country _RELAYCOUNTRY_


# How many points before a mail is considered spam.
# required_score		5

# Whitelist and blacklist addresses are now file-glob-style patterns, so
# "friend@somewhere.com", "*@isp.com", or "*.domain.net" will all work.
# whitelist_from	someone@somewhere.com

# Add your own customised scores for some tests below.  The default scores are
# read from the installed spamassassin rules files, but you can override them
# here.  To see the list of tests and their default scores, go to
# http://spamassassin.apache.org/tests.html .
#
# score SYMBOLIC_TEST_NAME n.nn

# Speakers of Asian languages, like Chinese, Japanese and Korean, will almost
# definitely want to uncomment the following lines.  They will switch off some
# rules that detect 8-bit characters, which commonly trigger on mails using CJK
# character sets, or that assume a western-style charset is in use. 
# 
# score HTML_COMMENT_8BITS	0
# score UPPERCASE_25_50		0
# score UPPERCASE_50_75		0
# score UPPERCASE_75_100	0
# score OBSCURED_EMAIL          0
score MIME_NO_TEXT	0
score T_DKIM_INVALID 0
score  URIBL_DBL_SPAM 4
# Speakers of any language that uses non-English, accented characters may wish
# to uncomment the following lines.   They turn off rules that fire on
# misformatted messages generated by common mail apps in contravention of the
# email RFCs.

# score SUBJ_ILLEGAL_CHARS      0

header XYZ_SUBJECT_BLACKLIST1 Subject =~ /(wechseln|gewinn|amazon|amazon europe|seller|selling|kosten|lidl|dyson|beitr|euro|\€|tarif|kasse|gardena|24)/i
tflags XYZ_SUBJECT_BLACKLIST1 autolearn_force
describe XYZ_SUBJECT_BLACKLIST1 Blacklisted word in Subject 1
score   XYZ_SUBJECT_BLACKLIST1     2


header XYZ_FROM_BLACKLIST1 From =~ /(wechseln|gewinn|amazon|amazon europe|seller|selling|kosten|lidl|dyson|beitr|euro|\€|tarif|kasse|gardena|24)/i
tflags XYZ_FROM_BLACKLIST1 autolearn_force
describe XYZ_FROM_BLACKLIST1 Blacklisted word in From 1
score   XYZ_FROM_BLACKLIST1     2

header XYZAmazonDEFrom From =~ /amazon.de/i
tflags XYZAmazonDEFrom autolearn_force
describe XYZAmazonDEFrom Amazon.de seems to be mostly a valid sender
score XYZAmazonDEFrom -2

header XYZUnsubscribe List-Unsubscribe =~ /http/i
tflags XYZUnsubscribe autolearn_force
describe XYZUnsubscribe List-Unsubscribe is nearly used in all SPAM messages.
score XYZUnsubscribe 2


header RELAYCOUNTRY_BAD X-Relay-Countries =~ /\b(?!DE|XX)[A-Z]{2}\b/
describe RELAYCOUNTRY_BAD First untrusted relay is not Germany
score RELAYCOUNTRY_BAD 1.5

header TLD_NOT_TRUSTED  From !~ /(\.de>|\.com>|\.net>|\.org>)\Z/
describe TLD_NOT_TRUSTED Domain of sender is not .de, .com, .net or .org
tflags TLD_NOT_TRUSTED autolearn_force
score TLD_NOT_TRUSTED 1.5

header TLD_BLACKLIST  From =~ /(\.space>|\.tld>|\.site>|\.review>|\.live>|\.me>|\.online>|\.email>|\.host>|\.ltd>|\.life>)\Z/
describe TLD_BLACKLIST Top-Level Domain of sender is .space, .tld, .site, .review, .live, .me, .online, .life, .host
tflags TLD_BLACKLIST autolearn_force
score TLD_BLACKLIST 3

header MAILBOX_CONTENT_X X-Spam =~ /Yes/i
describe MAILBOX_CONTENT_X Mailbox.org content filter positive match
tflags MAILBOX_CONTENT_X autolearn_force
score MAILBOX_CONTENT_X 10

header MAILBOX_CONTENT_X_Flag X-Spam-Flag =~ /YES/i
describe MAILBOX_CONTENT_X_Flag Mailbox.org content filter positive match
tflags MAILBOX_CONTENT_X_Flag autolearn_force
score MAILBOX_CONTENT_X_Flag 10

header __DOMAIN_DE  From =~ (/\.de>/i)
header __RELAYCOUNTRY_NOT_DE X-Relay-Countries =~ /\b(?!DE|US|XX)[A-Z]{2}\b/
meta RELAY_AND_DOMAIN __DOMAIN_DE && __RELAYCOUNTRY_NOT_DE
describe RELAY_AND_DOMAIN senders domain is .de, but first relay is not in GERMANY or US.
tflags RELAY_AND_DOMAIN autolearn_force
score RELAY_AND_DOMAIN 3

#########################
# customize some scores#

score LOTS_OF_MONEY 1
score NO_DNS_FOR_FROM 1

score TVD_SPACE_RATIO 0.5

score SPF_FAIL 0.5
tflags SPF_FAIL autolearn_force

score SPF_PASS -0.5

score RCVD_IN_DNSWL_LOW -0.5

score T_HTML_ATTACH 0.5
tflags T_HTML_ATTACH autolearn_force

score SURBL_BLOCKED 0.5
tflags SURBL_BLOCKED autolearn_force

score BAYES_999 10
tflags BAYES_999 autolearn_force

score BAYES_99 5
tflags BAYES_99 autolearn_force

score BAYES_00 -10

######################################
#test not functional in our scenario #
score RDNS_NONE 0
use_pyzor 0
# all messages are encrypted
score ENCRYPTED_MESSAGE 0

# we are only able to analyze the header, so we need autolearn_force rules
tflags BAYES_50 autolearn_force
tflags BAYES_60 autolearn_force
tflags BAYES_80 autolearn_force
bayes_auto_learn_threshold_spam 8.0
